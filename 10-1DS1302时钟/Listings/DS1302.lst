C51 COMPILER V9.54   DS1302                                                                11/22/2025 12:40:01 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE DS1302
OBJECT MODULE PLACED IN .\Objects\DS1302.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE DS1302.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\DS
                    -1302.lst) OBJECT(.\Objects\DS1302.obj)

line level    source

   1          #include <STC89C5xRC.H>
   2           
   3          sbit DS1302_SCLK=P3^6;
   4          sbit DS1302_IO=P3^4;
   5          sbit DS1302_CE=P3^5;
   6          /**
   7            * @brief  DS1302初始化
   8            * @param  无
   9            * @retval 无
  10            */
  11          void DS1302_Init()
  12          {
  13   1              DS1302_CE=0;
  14   1              DS1302_SCLK=0;  
  15   1      }
  16          
  17          
  18          
  19          /**
  20            * @brief  DS1302写入
  21            * @param  命令字，选择控制什么，
  22            * @retval 无
  23            */
  24          void DS1302_WriteByte(unsigned char Command,Date)
  25          {
  26   1              char i;
  27   1              DS1302_CE=1;
  28   1              
  29   1              for(i=0;i<8;i++)
  30   1              {
  31   2                      DS1302_IO=Command&(0x01<<i);
  32   2                      DS1302_SCLK=1;
  33   2                      DS1302_SCLK=0;
  34   2              
  35   2              }
  36   1              for(i=0;i<8;i++)
  37   1              {
  38   2                      DS1302_IO=Date&(0x01<<i);
  39   2                      DS1302_SCLK=1;
  40   2                      DS1302_SCLK=0;
  41   2              
  42   2              }
  43   1              DS1302_CE=0;    
  44   1      /*
  45   1              DS1302_CE=1;
  46   1              DS1302_IO=Command&0x01;
  47   1              DS1302_SCLK=1;
  48   1              DS1302_SCLK=0;
  49   1              DS1302_IO=Command&0x02;
  50   1              DS1302_SCLK=1;
  51   1              DS1302_SCLK=0;
  52   1              DS1302_IO=Command&0x04;
  53   1              DS1302_SCLK=1;
  54   1              DS1302_SCLK=0;
C51 COMPILER V9.54   DS1302                                                                11/22/2025 12:40:01 PAGE 2   

  55   1              DS1302_IO=Command&0x08;
  56   1              DS1302_SCLK=1;
  57   1              DS1302_SCLK=0;
  58   1              DS1302_IO=Command&0x10;
  59   1              DS1302_SCLK=1;
  60   1              DS1302_SCLK=0;
  61   1              DS1302_IO=Command&0x20;
  62   1              DS1302_SCLK=1;
  63   1              DS1302_SCLK=0;
  64   1              DS1302_IO=Command&0x40;
  65   1              DS1302_SCLK=1;
  66   1              DS1302_SCLK=0;
  67   1              DS1302_IO=Command&0x80;
  68   1              DS1302_SCLK=1;
  69   1              DS1302_SCLK=0;
  70   1              DS1302_CE=0;
  71   1              */      
  72   1      }
  73          /**
  74            * @brief  DS1302读出
  75            * @param  命令字
  76            * @retval 无
  77            */
  78          
  79          unsigned char DS1302_ReadByte(unsigned char Command)
  80          {
  81   1              char i,Date=0x00;
  82   1              DS1302_CE=1;
  83   1              
  84   1              for(i=0;i<8;i++)
  85   1              {
  86   2                      DS1302_IO=Command&(0x01<<i);
  87   2                      DS1302_SCLK=0;
  88   2                      DS1302_SCLK=1;
  89   2              
  90   2              }
  91   1              
  92   1              
  93   1              for(i=0;i<8;i++)
  94   1              {
  95   2                      DS1302_SCLK=1;
  96   2                      DS1302_SCLK=0;
  97   2                      if(DS1302_IO==1)
  98   2                      {
  99   3                              Date=Date|(0x01<<i);
 100   3                      }
 101   2                      
 102   2              }
 103   1              DS1302_CE=0;
 104   1              return Date;
 105   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    165    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       2
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.

C51 COMPILER V9.54   DS1302                                                                11/22/2025 12:40:01 PAGE 3   


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
